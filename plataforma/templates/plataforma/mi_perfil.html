{% extends "plataforma/base.html" %}

{% block content %}
<div class="container" style="padding: 40px 20px; max-width: 800px;">
    <h1 style="color: #2d5016; text-align: center; margin-bottom: 40px;">üë§ Mi Perfil</h1>

    {% if messages %}
        {% for message in messages %}
            <div style="padding: 15px; margin-bottom: 20px; border-radius: 5px; {% if message.tags %}background: {% if 'success' in message.tags %}#E8F5E9; color: #2e7d32; border-left: 4px solid #4CAF50;{% else %}#FFEBEE; color: #c62828; border-left: 4px solid #f44336;{% endif %}{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <form method="POST" style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        {% csrf_token %}

        <!-- Informaci√≥n de Rol -->
        <div style="background: #f5f5f5; padding: 20px; border-radius: 8px; margin-bottom: 30px; border-left: 4px solid #4CAF50;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <div style="color: #999; font-size: 12px; text-transform: uppercase; margin-bottom: 5px;">Usuario</div>
                    <div style="font-size: 16px; font-weight: bold; color: #333;">{{ user.username }}</div>
                </div>
                <div>
                    <div style="color: #999; font-size: 12px; text-transform: uppercase; margin-bottom: 5px;">Rol</div>
                    <div style="font-size: 16px; font-weight: bold; color: #4CAF50;">
                        {% if perfil.rol == 'ESTUDIANTE' %}
                            üë• Estudiante
                        {% elif perfil.rol == 'TRABAJADOR' %}
                            üè¢ Empresa
                        {% elif perfil.rol == 'FUNCIONARIO_SENA' %}
                            üë®‚Äçüíº Funcionario SENA
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Datos Personales -->
        <h2 style="color: #2d5016; margin-top: 30px; margin-bottom: 20px; border-bottom: 2px solid #4CAF50; padding-bottom: 10px;">üìù Informaci√≥n Personal</h2>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; color: #333; font-weight: bold; margin-bottom: 8px;">Nombres</label>
            <input type="text" name="first_name" value="{{ user.first_name }}" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;" placeholder="Ej: Juan Carlos">
        </div>

        <div style="margin-bottom: 20px;">
            <label style="display: block; color: #333; font-weight: bold; margin-bottom: 8px;">Apellidos</label>
            <input type="text" name="last_name" value="{{ user.last_name }}" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;" placeholder="Ej: G√≥mez L√≥pez">
        </div>

        <div style="margin-bottom: 20px;">
            <label style="display: block; color: #333; font-weight: bold; margin-bottom: 8px;">Correo Electr√≥nico</label>
            <input type="email" name="email" value="{{ user.email }}" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;" placeholder="Ej: ejemplo@mail.com">
        </div>

        <!-- Datos Espec√≠ficos por Rol -->
        {% if perfil.rol == 'ESTUDIANTE' and aprendiz %}
            <h2 style="color: #2d5016; margin-top: 30px; margin-bottom: 20px; border-bottom: 2px solid #2196F3; padding-bottom: 10px;">üéì Informaci√≥n del Aprendiz</h2>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #666; font-size: 12px; text-transform: uppercase; margin-bottom: 8px;">Correo Registrado</label>
                <div style="padding: 12px; background: #f5f5f5; border-radius: 5px; color: #333;">{{ aprendiz.correo }}</div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: bold; margin-bottom: 8px;">Tel√©fono</label>
                <input type="tel" name="telefono" value="{{ aprendiz.telefono }}" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;" placeholder="Ej: 3001234567">
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: bold; margin-bottom: 8px;">Ficha</label>
                <input type="text" name="ficha" value="{{ aprendiz.ficha }}" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;" placeholder="Ej: F12345">
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: bold; margin-bottom: 8px;">Programa de Formacion</label>
                <input type="text" name="programa_formacion" value="{{ aprendiz.programa_formacion }}" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;" placeholder="Ej: Tecnico en Sistemas">
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #666; font-size: 12px; text-transform: uppercase; margin-bottom: 8px;">Estado</label>
                <div style="padding: 12px; background: #E8F5E9; border-radius: 5px; color: #2e7d32; font-weight: bold;">
                    {% if not aprendiz.estado or aprendiz.estado|length == 0 or aprendiz.estado == 'DISPONIBLE' %}
                        ‚úì Disponible
                    {% elif aprendiz.estado == 'PROCESO_SELECCION' %}
                        ‚è≥ Proceso de Seleccion
                    {% elif aprendiz.estado == 'PROCESO_SELECCION_ABIERTO' %}
                        ‚Üí Seleccion Abierto
                    {% elif aprendiz.estado == 'CONTRATADO' %}
                        üéâ Contratado
                    {% elif aprendiz.estado == 'CONTRATO_NO_REGISTRADO' %}
                        ‚ö† Contrato no Registrado
                    {% elif aprendiz.estado == 'INHABILITADO_POR_ACTUALIZACION' %}
                        ‚ö† Inhabilitado
                    {% else %}
                        {{ aprendiz.estado }}
                    {% endif %}
                </div>
            </div>

        {% elif perfil.rol == 'TRABAJADOR' and empresa %}
            <h2 style="color: #2d5016; margin-top: 30px; margin-bottom: 20px; border-bottom: 2px solid #FF9800; padding-bottom: 10px;">üè¢ Informaci√≥n de la Empresa</h2>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #666; font-size: 12px; text-transform: uppercase; margin-bottom: 8px;">NIT</label>
                <div style="padding: 12px; background: #f5f5f5; border-radius: 5px; color: #333;">{{ empresa.nit }}</div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #666; font-size: 12px; text-transform: uppercase; margin-bottom: 8px;">Nombre de la Empresa</label>
                <div style="padding: 12px; background: #f5f5f5; border-radius: 5px; color: #333;">{{ empresa.nombre }}</div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: bold; margin-bottom: 8px;">Descripci√≥n</label>
                <textarea name="descripcion" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; resize: vertical; min-height: 100px;">{{ empresa.descripcion }}</textarea>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #333; font-weight: bold; margin-bottom: 8px;">Direcci√≥n</label>
                <input type="text" name="direccion" value="{{ empresa.direccion }}" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;" placeholder="Ej: Calle 10 # 20-30">
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; color: #666; font-size: 12px; text-transform: uppercase; margin-bottom: 8px;">Cupos Disponibles</label>
                <div style="padding: 12px; background: #E8F5E9; border-radius: 5px; color: #2e7d32; font-weight: bold;">
                    {{ empresa.cupos_disponibles }} cupos
                </div>
            </div>

        {% elif perfil.rol == 'FUNCIONARIO_SENA' %}
            <h2 style="color: #2d5016; margin-top: 30px; margin-bottom: 20px; border-bottom: 2px solid #9C27B0; padding-bottom: 10px;">üë®‚Äçüíº Informaci√≥n del Funcionario</h2>
            <p style="color: #666; padding: 20px; background: #f5f5f5; border-radius: 5px;">
                ‚úì Cuenta de Funcionario SENA con acceso a panel de administraci√≥n
            </p>
        {% endif %}

        <!-- Botones -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 30px;">
            <a href="{% url 'dashboard_reportes' %}" style="padding: 12px 20px; background: #999; color: white; text-decoration: none; border-radius: 5px; text-align: center; font-weight: bold;">
                ‚Üê Volver
            </a>
            <button type="submit" style="padding: 12px 20px; background: #4CAF50; color: white; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; font-size: 14px;">
                üíæ Guardar Cambios
            </button>
        </div>
    </form>
</div>
{% endblock %}
